import"../chunks/DsnmJJEf.js";import{i as Tt}from"../chunks/CJUEhHh_.js";import{o as ct,u as x,r as Bt,B as Ft,aT as qt,l as Rt,ad as zt,aU as Ot,aV as Ut,K as jt,aW as R,v as $t,w as Gt,Q as I,N as lt,I as e,y as S,C as A,F as g,A as E,x as Dt,aB as Jt,aD as Kt,G as wt,D as p,z as L,aX as X,J as w,aK as F,aL as Wt}from"../chunks/DgUB_kdk.js";import{b as Lt,i as Xt}from"../chunks/fdmEJK7E.js";import{S as Qt,e as Q,i as V}from"../chunks/D8mi12U7.js";import{s as Vt,r as Yt,a as Zt}from"../chunks/BARF5wSa.js";import{a as It}from"../chunks/9FAV4l13.js";import{p as N,s as te,a as q,b as G}from"../chunks/BIpve9mN.js";import{i as ee,a as ae,b as re,c as ne}from"../chunks/BTCkNl-z.js";function se(t,a,d){ct(()=>{var s=x(()=>a(t,d?.())||{});if(d&&s?.update){var r=!1,u={};Bt(()=>{var i=d();Ft(i),r&&qt(u,i)&&(u=i,s.update(i))}),r=!0}if(s?.destroy)return()=>s.destroy()})}function At(t,a,d=!1){if(t.multiple){if(a==null)return;if(!zt(a))return Ot();for(var s of t.options)s.selected=a.includes(J(s));return}for(s of t.options){var r=J(s);if(Ut(r,a)){s.selected=!0;return}}(!d||a!==void 0)&&(t.selectedIndex=-1)}function oe(t){var a=new MutationObserver(()=>{At(t,t.__value)});a.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),jt(()=>{a.disconnect()})}function Y(t,a,d=a){var s=!0;Rt(t,"change",r=>{var u=r?"[selected]":":checked",i;if(t.multiple)i=[].map.call(t.querySelectorAll(u),J);else{var l=t.querySelector(u)??t.querySelector("option:not([disabled])");i=l&&J(l)}d(i)}),ct(()=>{var r=a();if(At(t,r,s),s&&r===void 0){var u=t.querySelector(":checked");u!==null&&(r=J(u),d(r))}t.__value=r,s=!1}),oe(t)}function J(t){return"__value"in t?t.__value:t.value}function ie(t){return function(...a){var d=a[0];return d.preventDefault(),t?.apply(this,a)}}function le(t){const a=JSON.parse(t);return a.data&&(a.data=re(a.data,ne.decoders)),a}function rt(t){return HTMLElement.prototype.cloneNode.call(t)}function ce(t,a=()=>{}){const d=async({action:r,result:u,reset:i=!0,invalidateAll:l=!0})=>{u.type==="success"&&(i&&HTMLFormElement.prototype.reset.call(t),l&&await ee()),(location.origin+location.pathname===r.origin+r.pathname||u.type==="redirect"||u.type==="error")&&await ae(u)};async function s(r){if((r.submitter?.hasAttribute("formmethod")?r.submitter.formMethod:rt(t).method)!=="post")return;r.preventDefault();const i=new URL(r.submitter?.hasAttribute("formaction")?r.submitter.formAction:rt(t).action),l=r.submitter?.hasAttribute("formenctype")?r.submitter.formEnctype:rt(t).enctype,v=new FormData(t),k=r.submitter?.getAttribute("name");k&&v.append(k,r.submitter?.getAttribute("value")??"");const m=new AbortController;let C=!1;const b=await a({action:i,cancel:()=>C=!0,controller:m,formData:v,formElement:t,submitter:r.submitter})??d;if(C)return;let _;try{const h=new Headers({accept:"application/json","x-sveltekit-action":"true"});l!=="multipart/form-data"&&h.set("Content-Type",/^(:?application\/x-www-form-urlencoded|text\/plain)$/.test(l)?l:"application/x-www-form-urlencoded");const H=l==="multipart/form-data"?v:new URLSearchParams(v),P=await fetch(i,{method:"POST",headers:h,cache:"no-store",body:H,signal:m.signal});_=le(await P.text()),_.type==="error"&&(_.status=P.status)}catch(h){if(h?.name==="AbortError")return;_={type:"error",error:h}}await b({action:i,formData:v,formElement:t,update:h=>d({action:i,result:_,reset:h?.reset,invalidateAll:h?.invalidateAll}),result:_})}return HTMLFormElement.prototype.addEventListener.call(t,"submit",s),{destroy(){HTMLFormElement.prototype.removeEventListener.call(t,"submit",s)}}}let Et=!1,ue=()=>{Et=!0},nt=R(null),st=R(null),ot=R(null),it=R(null),xt=R("DESC"),Z=R([]);var de=S('<div style="text-align: center;" class="svelte-1so1zdl"><!></div>');function ve(t,a){$t(a,!1);let d=N(a,"once",8,!1),s=N(a,"top",8,0),r=N(a,"bottom",8,0),u=N(a,"left",8,0),i=N(a,"right",8,0),l=lt(!1),v=lt(),k=N(a,"onIntersectingTrue",8,()=>{});Gt(()=>{if(typeof IntersectionObserver<"u"){const b=`${r()}px ${u()}px ${s()}px ${i()}px`,_=new IntersectionObserver(h=>{I(l,h[0].isIntersecting),e(l)&&k()(),e(l)&&d()&&_.unobserve(e(v))},{rootMargin:b});return _.observe(e(v)),()=>_.unobserve(e(v))}function $(){const b=e(v).getBoundingClientRect();I(l,b.bottom+r()>0&&b.right+i()>0&&b.top-s()<window.innerHeight&&b.left-u()<window.innerWidth),console.info(b.top,b.bottom,b.left,b.right),e(l)&&k()(),e(l)&&d()&&window.removeEventListener("scroll",$)}return window.addEventListener("scroll",$),()=>window.removeEventListener("scroll",$)}),Tt();var m=de(),C=A(m);Vt(C,a,"default",{get intersecting(){return e(l)}}),g(m),Lt(m,$=>I(v,$),()=>e(v)),E(t,m),Dt()}var fe=S("<option> </option>"),pe=S("<option> </option>"),be=S("<option> </option>"),_e=S('<div class="no-results-message svelte-1uha8ag">No students found</div>'),me=S('<a class="result-card svelte-1uha8ag"><div class="list-index svelte-1uha8ag"></div> <br/> <br/> <br/> <br/> <div class="ranks svelte-1uha8ag"> <br/> <br/> <br/></div></a>'),he=S('<div class="result-card-list svelte-1uha8ag"></div> <!>',1),ge=S('<form id="root_form" method="POST" class="svelte-1uha8ag"><input type="text" id="search" name="search" placeholder="Search by roll number or name" class="svelte-1uha8ag"/> <select id="branch" name="branch" class="svelte-1uha8ag"></select> <select id="batch" name="batch" class="svelte-1uha8ag"></select> <select id="sort" name="sort" class="svelte-1uha8ag"></select> <select id="sort_order" name="sort_order" class="svelte-1uha8ag"><option>Descending</option><option>Ascending</option></select> <button type="submit" class="submit-button svelte-1uha8ag">Submit</button></form> <!>',1);function Se(t,a){$t(a,!1);const d=()=>q(nt,"$search",v),s=()=>q(st,"$branch",v),r=()=>q(ot,"$batch",v),u=()=>q(it,"$sort",v),i=()=>q(xt,"$ascDesc",v),l=()=>q(Z,"$resultList",v),[v,k]=te();let m=N(a,"data",8);const C=m().branches,$=m().bataches,b=m().sortTypes;Et||(nt.set(""),st.set(C[0]),ot.set($[0]),it.set(b[0]),Z.set(m().list),ue());let _=setTimeout(()=>{},300);function h(){clearTimeout(_),_=setTimeout(B,300)}let H=-1,P=lt();function B(){H=-1,e(P).click()}async function St(){H==-1?H=1:H+=1;const T=new FormData;T.append("search",d()),T.append("branch",s()),T.append("batch",r()),T.append("sort",u()),T.append("sort_order",i()),T.append("load_page",H);const tt=await fetch("/",{method:"POST",body:T});tt.body;const M=(await tt.json()).list??[];Z.set(l().concat(...M))}function kt(){setTimeout(()=>{},1e3)}Tt(),Jt(T=>{Kt.title="NITH results"}),Qt(t,{title:"NITH Results",description:"NIT Hamirpur semester results",canonical:"result-nith-rg.vercel.app/",children:(T,tt)=>{var et=ge(),M=wt(et),K=A(M);Yt(K);var z=p(K,2);L(()=>{s(),X(()=>{})}),Q(z,5,()=>C,V,(n,f)=>{var c=fe(),D=A(c,!0);g(c);var y={};L(()=>{w(D,e(f)),y!==(y=e(f))&&(c.value=(c.__value=e(f))??"")}),E(n,c)}),g(z);var O=p(z,2);L(()=>{r(),X(()=>{})}),Q(O,5,()=>$,V,(n,f)=>{var c=pe(),D=A(c,!0);g(c);var y={};L(()=>{w(D,e(f)),y!==(y=e(f))&&(c.value=(c.__value=e(f))??"")}),E(n,c)}),g(O);var U=p(O,2);L(()=>{u(),X(()=>{})}),Q(U,5,()=>b,V,(n,f)=>{var c=be(),D=A(c,!0);g(c);var y={};L(()=>{w(D,e(f)),y!==(y=e(f))&&(c.value=(c.__value=e(f))??"")}),E(n,c)}),g(U);var j=p(U,2);L(()=>{i(),X(()=>{})});var at=A(j);at.value=at.__value="DESC";var ut=p(at);ut.value=ut.__value="ASC",g(j);var Ct=p(j,2);Lt(Ct,n=>I(P,n),()=>e(P)),g(M),ct(()=>F("submit",M,ie(B))),se(M,(n,f)=>ce?.(n,f),()=>({form:n,data:f,action:c,cancel:D,submitter:y})=>async({result:o,update:dt})=>{(o.type==="success"||o.type==="failure")&&(o.type=="failure"?kt():Z.set(o.data?.list??[]))});var Ht=p(M,2);{var Mt=n=>{var f=_e();E(n,f)},Nt=n=>{var f=he(),c=wt(f);Q(c,5,l,V,(y,o,dt)=>{var W=me(),vt=A(W);vt.textContent=`#${dt+1}`;var ft=p(vt),pt=p(ft,2),bt=p(pt,2),_t=p(bt,2),mt=p(_t,2),ht=p(mt),gt=A(ht),yt=p(gt,2),Pt=p(yt,2);Wt(),g(ht),g(W),L(()=>{Zt(W,"href",`/${e(o),x(()=>e(o).roll_number)??""}`),w(ft,` ${e(o),x(()=>e(o).name)??""}`),w(pt,` RollNumber: ${e(o),x(()=>e(o).roll_number)??""} `),w(bt,` Branch: ${e(o),x(()=>e(o).branch)??""} `),w(_t,` Batch: ${e(o),x(()=>e(o).batch)??""} `),w(mt,` CGPI: ${e(o),x(()=>e(o).cgpi)??""} `),w(gt,`Class #${e(o),x(()=>e(o).class_rank)??""}`),w(yt,` Branch #${e(o),x(()=>e(o).branch_rank)??""}`),w(Pt,` Year #${e(o),x(()=>e(o).year_rank)??""}`)}),E(y,W)}),g(c);var D=p(c,2);ve(D,{top:200,onIntersectingTrue:St}),E(n,f)};Xt(Ht,n=>{l(),x(()=>l().length==0)?n(Mt):n(Nt,!1)})}It(K,d,n=>G(nt,n)),F("input",K,h),Y(z,s,n=>G(st,n)),F("change",z,B),Y(O,r,n=>G(ot,n)),F("change",O,B),Y(U,u,n=>G(it,n)),F("change",U,B),Y(j,i,n=>G(xt,n)),F("change",j,B),E(T,et)},$$slots:{default:!0}}),Dt(),k()}export{Se as component};
